# ============================================================
# ğŸ§­ Aila Project Deployment Mapping
# ------------------------------------------------------------
# æœ¬æ–‡ä»¶å®šä¹‰äº† VSCode ä»“åº“ä¸­å„ç›®å½•ä¸å®¿ä¸»ç³»ç»Ÿçš„æ˜ å°„å…³ç³»ã€‚
# å®ƒè¢« deploy_to_nixos.sh / sync_container.sh ç­‰è„šæœ¬è§£æï¼Œ
# ç”¨äºè‡ªåŠ¨åŒæ­¥ã€æƒé™é…ç½®ä¸å®¹å™¨æ˜ å°„ã€‚
# ============================================================

version: 0.2
author: "Mason / ç‹èŒ"
updated: "2025-10-15"

mappings:
  # ============================================================
  # ğŸ§± å®¿ä¸»å±‚ï¼ˆHost Systemï¼‰
  # ------------------------------------------------------------
  # åŒ…å« NixOS é…ç½®æ–‡ä»¶ã€ç¡¬ä»¶å£°æ˜ã€æ—¥å¿—è·¯å¾„æ˜ å°„
  # ============================================================
  - name: system-config
    src: system/etc/nixos/
    dst: /etc/nixos/
    sudo: true
    description: "ç³»ç»Ÿé…ç½®å£°æ˜ä¸ç¡¬ä»¶æ¨¡å—ï¼ˆconfiguration.nix / hardware.nixï¼‰"

  - name: system-logs
    src: system/var/log/aila/
    dst: /var/log/aila/
    sudo: true
    description: "å®¿ä¸»æ—¥å¿—è·¯å¾„ï¼ˆåŒæ­¥ç”¨äºç¦»çº¿è°ƒè¯•ï¼‰"

  - name: system-opt
    src: system/opt/aila/
    dst: /opt/aila/
    sudo: true
    description: "ç³»ç»Ÿçº§å¯æ‰§è¡Œç»„ä»¶ä¸å…±äº«æ¨¡å—ï¼ˆAIæ¥å£ / è„šæœ¬ï¼‰"

  # ============================================================
  # âš™ï¸ æœåŠ¡å±‚ï¼ˆOrgansï¼‰
  # ------------------------------------------------------------
  # å„åŠŸèƒ½æœåŠ¡ï¼šWhisperã€Ollamaã€Piperã€Monitor
  # ============================================================
  - name: ollama-service
    src: services/ollama/systemd/
    dst: /etc/systemd/system/
    sudo: true
    description: "Ollama æ¨ç†æœåŠ¡ï¼ˆGPU è¯­è¨€æ¨¡å‹ï¼‰"

  - name: ollama-config
    src: services/ollama/config/
    dst: /etc/ollama/
    sudo: true
    description: "Ollama æ¨¡å‹é…ç½®ä¸ç«¯å£å£°æ˜"

  # ===========================================================
  # ğŸ§ WHISPER æ¨¡å—ï¼ˆè¯­éŸ³è¯†åˆ« + å”¤é†’æ£€æµ‹ï¼‰
  # ===========================================================
  - name: whisper-service
    src: services/whisper/systemd/
    dst: /etc/systemd/system/
    sudo: true
    description: "Whisper ä¸»ç›‘å¬å®ˆæŠ¤è¿›ç¨‹ï¼ˆå®æ—¶è¯†åˆ«è¯­éŸ³å¹¶è§¦å‘å›åº”ï¼‰"

  - name: whisper-config
    src: services/whisper/config/
    dst: /etc/whisper/
    sudo: true
    description: "Whisper é…ç½®æ–‡ä»¶ï¼ˆæ¨¡å‹è·¯å¾„ã€é‡‡æ ·ç‡ã€è¯­è¨€ç­‰å‚æ•°ï¼‰"

  - name: whisper-scripts
    src: services/whisper/scripts/
    dst: /usr/local/bin/
    sudo: true
    description: "Whisper è¾…åŠ©è„šæœ¬ï¼ˆå½•éŸ³ã€æ–‡å­—è½¬è¯­éŸ³ã€æ¥å£è°ƒè¯•ï¼‰"

  - name: whisper-main
    src: services/whisper/main/
    dst: /opt/aila/whisper/
    sudo: true
    description: "Whisper ä¸»é€»è¾‘ç¨‹åºï¼ˆå”¤é†’æ£€æµ‹ + è°ƒç”¨ Ollama + è°ƒç”¨ Piper æ’­æ”¾ï¼‰"


  - name: piper-service
    src: services/piper/systemd/
    dst: /etc/systemd/system/
    sudo: true
    description: "Piper è¯­éŸ³åˆæˆæœåŠ¡å®ˆæŠ¤è¿›ç¨‹"

  - name: piper-config
    src: services/piper/config/
    dst: /etc/piper/
    sudo: true
    description: "Piper é…ç½®æ–‡ä»¶ï¼ˆæ¨¡å‹è·¯å¾„ / éŸ³é‡ / è¯­è¨€ï¼‰"

  - name: piper-main
    src: services/piper/main/
    dst: /opt/aila/piper/
    sudo: true
    description: "Piper ä¸»ç¨‹åºï¼ˆTTS æ¥å£ä¸æ’­æ”¾é€»è¾‘ï¼‰"

  - name: piper-scripts
    src: services/piper/scripts/
    dst: /usr/local/bin/
    sudo: true
    description: "Piper è¾…åŠ©è„šæœ¬ï¼ˆå‘½ä»¤è¡Œæ’­æ”¾æ–‡æœ¬ï¼‰"
    
  - name: piper-install-script
    src: services/piper/scripts/
    dst: /usr/local/bin/
    sudo: true
    description: "Piper æ¨¡å‹è‡ªåŠ¨ä¸‹è½½ä¸æµ‹è¯•è„šæœ¬ï¼ˆinstall_piper_model.shï¼‰"


  - name: monitor-service
    src: services/monitor/systemd/
    dst: /etc/systemd/system/
    sudo: true
    description: "ç›‘æ§æ¨¡å—ï¼ˆæ—¥å¿—ä¸å®¹å™¨å¿ƒè·³ï¼‰"

  - name: monitor-scripts
    src: services/monitor/scripts/
    dst: /opt/aila/monitor/
    sudo: true
    description: "ç›‘æ§è„šæœ¬ä¸è‡ªæ„ˆé€»è¾‘"

  # ============================================================
  # ğŸŒŒ ç²¾ç¥å±‚ï¼ˆAila Coreï¼‰
  # ------------------------------------------------------------
  # Aila çš„æ ¸å¿ƒæ„è¯†ä¸æ„ŸçŸ¥é€»è¾‘ï¼ˆå®¹å™¨å†…éƒ¨ / å®¿ä¸»é•œåƒï¼‰
  # ============================================================
  - name: aila-core
    src: aila/
    dst: /opt/aila/
    sudo: true
    description: "Aila ç²¾ç¥æ ¸å¿ƒï¼šfeel / mind / dream æ¨¡å—"

  - name: aila-models
    src: aila/link/
    dst: /opt/aila/link/
    sudo: true
    description: "Whisper / Llama æ¨¡å‹æ–‡ä»¶æ˜ å°„è·¯å¾„"

  # ============================================================
  # ğŸ§  ç¥ç»å±‚ï¼ˆScriptsï¼‰
  # ------------------------------------------------------------
  # è‡ªåŠ¨åŒ–æ§åˆ¶é€»è¾‘ï¼šéƒ¨ç½²ã€åŒæ­¥ã€æ›´æ–°ã€æ—¥å¿—åˆ†æ
  # ============================================================
  - name: scripts
    src: scripts/
    dst: /usr/local/bin/
    sudo: true
    description: "éƒ¨ç½²ä¸æ§åˆ¶è„šæœ¬ï¼ˆdeploy / sync / update / launchï¼‰"

  # ============================================================
  # ğŸª¶ éƒ¨ç½²å£°æ˜å±‚ï¼ˆDeployï¼‰
  # ------------------------------------------------------------
  # ä¸ä¼šå®é™…éƒ¨ç½²ï¼Œåªè¢«è„šæœ¬è§£æç”¨äºæ˜ å°„æ§åˆ¶ã€‚
  # ============================================================
  - name: deploy-config
    src: deploy/
    dst: /opt/aila/deploy/
    sudo: true
    description: "éƒ¨ç½²è§„åˆ™å£°æ˜ç›®å½•ï¼ˆmapping.yaml / exclude / readmeï¼‰"

  # ============================================================
  # ğŸ§© å®¹å™¨æ˜ å°„å±‚ï¼ˆContainersï¼‰
  # ------------------------------------------------------------
  # ä»…åŒæ­¥é…ç½®ï¼Œä¸éƒ¨ç½²å®é™… rootfsã€‚
  # ============================================================
  - name: containers
    src: system/containers/
    dst: /etc/nixos/containers/
    sudo: true
    description: "Aila / Reflector / WebServer å®¹å™¨å£°æ˜æ¨¡å—"

# ============================================================
# ğŸ§© æ’é™¤è§„åˆ™å¼•ç”¨ï¼ˆä¾› rsync ä½¿ç”¨ï¼‰
# ------------------------------------------------------------
# å¯é€‰ï¼šdeploy/rsync-exclude.txt å®šä¹‰å…·ä½“æ’é™¤æ–‡ä»¶
# ============================================================
exclude_file: deploy/rsync-exclude.txt

# ============================================================
# ğŸš€ åŒæ­¥ç­–ç•¥å‚æ•°ï¼ˆä¾› deploy_to_nixos.sh è°ƒç”¨ï¼‰
# ------------------------------------------------------------
# - mode: mirrorï¼ˆå®Œå…¨é•œåƒåŒæ­¥ï¼‰
# - dry_run: æ˜¯å¦æ¨¡æ‹Ÿ
# - backup: æ˜¯å¦ç”Ÿæˆ .bak å‰¯æœ¬
# ============================================================
sync_policy:
  mode: mirror
  dry_run: false
  backup: true
  preserve_permissions: true
  show_progress: true